<% layout('../../../layouts/client/app') %>

<% stylesheet('/public/client/css/styleOrderHistory.css') %>

<% block('title', 'Trang chủ') %>

<div id="contents">
    
    <div class="titleArea">
       <h2>Tất cả đơn hàng</h2>
    </div>
    <div class="xans-element- xans-myshop xans-myshop-orderhistorytab ec-base-tab ">
       <ul class="menu">
          <li class="selected"><a href="/nguoi-dung/don-hang">Tất cả đơn hàng</a></li>
          <li class=""><a href="">Đơn hàng chi tiết</a></li>
       </ul>
    </div>
    <form method="GET" id="OrderHistoryForm" name="OrderHistoryForm" >
       <div class="xans-element- xans-myshop xans-myshop-orderhistoryhead ">
          <fieldset class="ec-base-box">
             <legend>Tìm kiếm</legend>
             <div class="stateSelect ">
                <select id="order_status" name="order_status" class="fSelect" >
                   <option value="all">Tất cả</option>
                   <option value="shipped_before">Chưa giao hàng</option>
                   <option value="shipped_standby">Chờ giao hàng</option>
                   <option value="shipped_begin">Đang giao hàng</option>
                   <option value="shipped_complate">Đã giao hàng</option>
                   <option value="order_cancel">Hủy đơn hàng</option>
                   <option value="order_exchange">Đổi sản phẩm</option>
                   <option value="order_return">Trả sản phẩm</option>
                </select>
             </div>
             
             <input id="history_start_date" name="history_start_date" class="fText" readonly="readonly" size="10" value="2018-06-13" type="text"  /> ~ <input id="history_end_date" name="history_end_date" class="fText" readonly="readonly" size="10" value="2018-09-11" type="text"  />        <input alt="조회" id="order_search_btn" type="image" src="//img.echosting.cafe24.com/skin/admin_ko_KR/myshop/btn_search.gif"  />    
          </fieldset>
          <ul>
             <li>Nhấp vào số đơn đặt hàng để xem chi tiết đơn đặt hàng.</li>
             <li>Đơn hủy / đổi / trả lại có thể được thực hiện tối đa 30 ngày kể từ ngày hoàn thành đơn đặt hàng.</li>
          </ul>
       </div>
       <input id="mode" name="mode" value="" type="hidden"  />
       <input id="term" name="term" value="" type="hidden"  />
    </form>
    <div class="xans-element- xans-myshop xans-myshop-orderhistorylistitem ec-base-table typeList">
       <!--
          $login_url = /member/login.html
          -->
       <div class="title">
          <h3>THÔNG TIN ĐƠN ĐẶT HÀNG</h3>
       </div>
       <table border="1" summary="">
          <caption>주문 상품 정보</caption>
          <colgroup>
             <col style="width:135px;"/>
             <col style="width:93px;"/>
             <col style="width:auto;"/>
             <col style="width:61px;"/>
             <col style="width:111px;"/>
             <col style="width:111px;"/>
             <col style="width:111px;"/>
          </colgroup>
          <thead>
             <tr>
                <th scope="col">Mã đơn hàng</th>
                <th scope="col">Hình ảnh</th>
                <th scope="col">Sản phẩm</th>
                <th scope="col">Số lượng</th>
                <th scope="col">Thành tiền</th>
                <th scope="col">Trạng thái đơn hàng</th>
                <th scope="col">Hủy/ đổi</th>
             </tr>
          </thead>
          <tbody class="center ">
             <% if(bills.docs.length !== 0) { %>
             <% bills.docs.forEach((bill) => { %>
             <tr class="">
                <td  class="number ">
                   <a href="/nguoi-dung/don-hang/<%= bill.code %>"><%= bill.code %> </a>
                </td>
                <td class="time">
                   <%= moment(bill.createAt).format('L') %>
                </td>
                <td class="name">
                   <% if(bill.productBill.length > 3) {%>
                   <a href="/nguoi-dung/don-hang/<%= bill.code %>"><%= bill.productBill[0].product.name %> và <%= bill.productBill.length -1 %> sản phẩm khác</a>
                   <% } else { %>
                   <% bill.productBill.forEach((p) => { %>
                   <a href="/nguoi-dung/don-hang/<%= bill.code %>"><%= p.product.name %>, </a>
                   <% }) %>
                   <% } %>
                </td>
                <td class="quantity"> <%= bill.productBill.length %></td>
                <td class="right price">
                   <strong><%= bill.price %></strong>
                </td>
                <td class="status">
                   <%= bill.isApproved === 'false' ? 'Chưa xác nhận' : 'Đã xác nhận'  %>
                </td>
                <td>
                   <a href="#">Hủy/ đổi/ trả</a>
                </td>
             </tr>
             <% }) %>
             <% } %>
          </tbody>
       </table>
       <% if(bills.docs.length === 0 ) { %>
       <p class="message ">Chưa có đơn đặt hàng nào.</p>
       <% } %>
    </div>
    <% if(bills.docs.length !== 0 ) { %>
    <div class="card-footer clearfix order" style="margin-top: 30px;">
       <div class="pagination-list">
          <%- bills.renderPagination(bills, query.page) %>
       </div>
    </div>
    <% } %>
</div>
